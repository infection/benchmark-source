# Code Generator

A standalone PHP code generation tool for creating large-scale source and test files for
benchmarking purposes.

## Overview

This directory contains the code generator that produces all files under `../src/AutoGenerated/` and
`../tests/AutoGenerated/`. It is isolated in its own directory to prevent accidental execution
within the benchmark codebase, as generated tests may have side effects.


## Usage

### Generate Files

Generate auto-generated source and test files:

```shell
bin/console generate --help
```


## Architecture

### File Generators

The generator uses a registry pattern to manage multiple file generators. Each generator implements
the `FileGenerator` interface and produces a `GeneratedFile` containing the file path and content.


## Adding New Generators

To add new auto-generated file types:

### Step 1: Create Generator Class

Create a new generator implementing the `FileGenerator` interface:

```php
<?php

declare(strict_types=1);

namespace Infection\BenchmarkCodeGenerator\FileGenerator;

final readonly class MyCustomGenerator implements FileGenerator
{
    private const TEMPLATE = <<<'PHP'
    <?php

    declare(strict_types=1);

    namespace Infection\BenchmarkSource\AutoGenerated\MyCustom;

    final class MyClass__ID__
    {
        // Your generated code template here
    }

    PHP;

    public function generate(string $id): GeneratedFile
    {
        return new GeneratedFile(
            sprintf('src/AutoGenerated/MyCustom/MyClass%s.php', $id),
            str_replace('__ID__', $id, self::TEMPLATE),
        );
    }
}
```

### Step 2: Register Generator

Add your generator to `GeneratorRegistry::create()`:

```php
public static function create(): self
{
    return new self(
        new ResourceFinderGenerator(),
        new ResourceFinderTestGenerator(),
        // ... existing generators ...
        new MyCustomGenerator(),        // Add your generator
        new MyCustomTestGenerator(),    // Add a corresponding test generator
    );
}
```

### Step 3: Generate Files

See the parent README.md.


## License

This project is licensed under the MIT License.
